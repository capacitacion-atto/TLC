{"files":[{"id":"e11f978f-af15-4a79-a6c5-0d866ab8e869","name":"CÃ³digo","type":"server_js","source":"var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1lxK_Dj4_GRIXF78wZrfyiaNDGr524WofTYqxqzRLLzc/edit#gid\u003d0\");\n\nvar sheet \u003d ss.getSheetByName(\"base\");\n    \nfunction doGet(e){\n    return getdata(e);\n }\n \n function doPost(e){\n    return getdata(e);\n }\n \n function getdata(e){\n     var dni\u003de.parameter.dni\n\t var jo \u003d {};\n\t var dataArray \u003d [];// collecting data from 2nd Row , 1st column to last row and last column\n\t var rows \u003d sheet.getRange(2,1,sheet.getLastRow()-1, sheet.getLastColumn()).getValues();\n     for(var i \u003d 0 ; i \u003c rows.length; i++){\n       \n       if(rows[i][1]\u003d\u003ddni){\n\t\t var dataRow \u003d rows[i];\n\t\t var record \u003d {};\n\t\t record[\u0027ID\u0027] \u003d dataRow[0];\n\t\t record[\u0027DNI\u0027] \u003d dataRow[1];\n\t\t record[\u0027ASESOR\u0027] \u003d dataRow[2];\n\t\t record[\u0027GAP\u0027] \u003d dataRow[3];\n\t\t record[\u0027PGAP\u0027] \u003d dataRow[4];\n\t\t record[\u0027NT\u0027] \u003d dataRow[5];\n\t\t record[\u0027PNT\u0027] \u003d dataRow[6];\n         record[\u0027WINCRM\u0027] \u003d dataRow[7];\n         record[\u0027PWINCRM\u0027] \u003d dataRow[8];\n         record[\u0027INTRA\u0027] \u003d dataRow[9];\n         record[\u0027IDA\u0027] \u003d dataRow[10];\n\t\t dataArray.push(record);\n         i\u003di+2;\n\t\t }}\n         \n         \n\t\t jo.user \u003d dataArray;\n\t\t var result \u003d JSON.stringify(jo);\n\t\t return ContentService.createTextOutput(result).setMimeType(ContentService.MimeType.JSON);\n\t\t }"},{"id":"8a03ce57-9faa-41a0-abd6-579987867a17","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Argentina/Buenos_Aires\",\n  \"dependencies\": {\n  },\n  \"webapp\": {\n    \"access\": \"ANYONE_ANONYMOUS\",\n    \"executeAs\": \"USER_DEPLOYING\"\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"}]}